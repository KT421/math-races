---
title: "Math Races Workbook"
author: "Katelyn Schreyer"
date: "2023-04-20"
output: html_document
runtime: shiny
---

# Description

This document is for working/scratch code for a shiny app that will produce math worksheets for kids.

Starting features: Generates a worksheet of 20 math problems, in large font

Addition with operands between 0 and 5
Subtraction with operands between 0 and 5, no negative numbers in results

Later features:
Operand ranges
Allow negative results
Multiplication and Division

# Basic Logic

```{r}

#Addition

addition_problem <- function(range1 = 1:5, range2 = 1:5) {
  operand1 <- ifelse(length(range1) == 1, range1, sample(range1,1))
  operand2 <- ifelse(length(range2) == 1, range2, sample(range2,1))
  paste(operand1, "+", operand2, "=")
}

# Subtraction
subtraction_problem <- function(range1 = 1:5, range2 = 1:5, allow_negatives = F) {
  operand1 <- ifelse(length(range1) == 1, range1, sample(range1,1))
  operand2 <- ifelse(length(range2) == 1, range2, sample(range2,1))
  
  if (all(!allow_negatives, operand2 > operand1)) {
    while (operand2 > operand1) {
      operand2 <- sample(range2,1)
    }
  }
  
  paste(operand1, "-", operand2, "=")
}


```



# idea

Maybe an entirely different approach?

Generate operand 1 and 2, select operator, if the operator is '-' then check for negatives

```{r}
# named list for replacement
operation_lookup <- c("Addition" = "+",
                      "Subtraction" = "-",
                      "Multiplication" = "*", 
                      "Division" = "รท")

# make problem
generate_problem <- function(range1,range2,operations,allow_negatives = F, div_remainders = F) {
  
  operand1 <- ifelse(length(range1) == 1, range1, sample(range1,1))
  operand2 <- ifelse(length(range2) == 1, range2, sample(range2,1))
  operation <- ifelse(length(operations) == 1, operations, sample(operations,1))
  
  # rerolls for subtraction - negative answers
  if (all(!allow_negatives, operand2 > operand1, operation == "Subtraction")) {
    while (operand2 > operand1) {
      operand1 <- ifelse(length(range1) == 1, range1, sample(range1,1))
      operand2 <- ifelse(length(range2) == 1, range2, sample(range2,1))
    }
  }
  
  # rerolls for division
  # no divide by zero plz
  if (all(operation == "Division", operand2 == 0)) {
    operand2 <- 1
  }
  # reroll if we don't want remainders
  if (all(!div_remainders, operand1 %% operand2 != 0, operation == "Division")) {
    while (operand1 %% operand2 != 0) {
      operand1 <- ifelse(length(range1) == 1, range1, sample(range1,1))
      operand2 <- ifelse(length(range2) == 1, range2, sample(range2,1))
        if (operand2 == 0) operand2 <- 1
    }
  }
  
  paste(operand1, operation_lookup[operation], operand2, "=")
  
}

```

```{r}
# testing

range1 <- 1:1000
range2 <- 0:10
operations <- c("Division")

generate_problem(range1, range2, operations)

operand1 <- 1
operand2 <- 5


```

